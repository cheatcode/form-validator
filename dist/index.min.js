!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).hypothesis=e()}(this,(function(){"use strict";const t=require("axios");return class{constructor(t,e={}){t||this._throwFormattedError("A valid API key is required."),this.apiKey=t,this.productCustomerId=e.productCustomerId||null,this.debug=e.debug||!1,this.customers={current:this._showCurrentCustomer.bind(this),login:this._loginCustomer.bind(this),logout:this._logoutCustomer.bind(this),create:this._createCustomer.bind(this),update:this._updateCustomer.bind(this),delete:this._deleteCustomer.bind(this),bulk:{create:this._bulkCreateCustomers.bind(this)}}}_logDebugMessage(t){console.log("( Hypothesis.js )"),console.log(t)}_throwFormattedError(t){throw new Error(`[Hypothesis] ${t} See https://www.notion.so/Hypothesis-js-Reference-3618ad6c2d5d4447a762a8f63f627efa.`)}_request(e,s,r={}){return this.debug&&this._logDebugMessage({method:e,url:"https://api.hypothesis.app/v1"+s,headers:{"x-api-key":this.apiKey},data:r}),t({method:e,url:"https://api.hypothesis.app/v1"+s,headers:{"x-api-key":this.apiKey},data:r}).then(t=>t&&t.data&&t.data.data).catch(t=>{if(console.warn(t.response),t&&t.response){const{status:e}=t.response,s=t.response&&t.response.data&&t.response.data&&t.response.data.data&&t.response.data.data.error;if(console.warn(`[${e}] ${s}`),this.debug&&t.response.data&&t.response.data.data)return this._logDebugMessage(t.response.data.data.error),this._logDebugMessage(t.response.data.data.validationErrors),t.response.data}})}track(t,e){if(!t)throw new Error("Must pass a key to track.");const s={key:t};return this.productCustomerId&&(s.productCustomerId=this.productCustomerId),!this.productCustomerId&&e&&e.productCustomerId&&(s.productCustomerId=e.productCustomerId,delete e.productCustomerId),e&&(s.properties=e),this._request("post","/behavior",s)}_showCurrentCustomer(){const t={productCustomerId:this.productCustomerId};return console.log(t),t}_loginCustomer(t){if(!t)throw new Error("Must pass a productCustomerId.");return this.productCustomerId=t,this._request("put","/customers/login",{productCustomerId:t})}_logoutCustomer(t){if(!t&&!this.productCustomerId)throw new Error("Must have a productCustomerId to logout.");return this._request("put","/customers/logout",{productCustomerId:t||this.productCustomerId},()=>{this.productCustomerId=null})}_createCustomer(t){if(!t)throw new Error("Must pass a customer.");return this._request("post","/customers",{...t})}_updateCustomer(t,e){if(!t)throw new Error("Must pass a productCustomerId.");if(!e)throw new Error("Must pass an update for the customer.");return this._request("put","/customers/"+t,{...e})}_deleteCustomer(t){if(!t)throw new Error("Must pass a productCustomerId.");return this._request("delete","/customers/"+t)}_bulkCreateCustomers(t){if(!t||t&&!t.productCustomers)throw new Error("Must pass an array of productCustomers.");return this._request("post","/customers/bulk",t)}}}));
